# batchtest - OpenAI Batch API ν…μ¤νΈ

## κ°μ”
μ΄ ν΄λ”λ” OpenAI Batch APIμ ν…μ¤νΈ λ° κ²€μ¦μ„ μ„ν• νμΌλ“¤μ„ ν¬ν•¨ν•©λ‹λ‹¤. Batch APIλ¥Ό ν†µν• λ€λ‰ μ²λ¦¬μ μ„±λ¥κ³Ό μ •ν™•μ„±μ„ ν™•μΈν•κ³ , λ‹¤μ–‘ν• μ‹λ‚λ¦¬μ¤λ¥Ό ν…μ¤νΈν•©λ‹λ‹¤.

## μ£Όμ” νμΌ

### π“ **ν…μ¤νΈ λ°μ΄ν„°**
- **`batchinput.jsonl`** - Batch API μ…λ ¥ λ°μ΄ν„°
  - JSONL(JSON Lines) ν•μ‹
  - κ° λΌμΈλ§λ‹¤ κ°λ³„ μ”μ²­ λ°μ΄ν„°
  - νλ¥΄μ†λ‚λ³„ μ§λ¬Έ μ‘λ‹µ μƒμ„± μ”μ²­

### π”¬ **ν…μ¤νΈ λ…ΈνΈλ¶**
- **`create_patients_answer (1).ipynb`** - Jupyter λ…ΈνΈλ¶
  - κ°€μƒν™μ μ‘λ‹µ μƒμ„± ν…μ¤νΈ
  - λ‹¤μ–‘ν• TCI μ΅°ν•© ν…μ¤νΈ
  - μ‘λ‹µ ν’μ§ λ° μΌκ΄€μ„± κ²€μ¦

## Batch API ν…μ¤νΈ λ©μ 

### **1. μ„±λ¥ κ²€μ¦**
- **μ²λ¦¬ μ†λ„**: κ°λ³„ API νΈμ¶ λ€λΉ„ Batch μ²λ¦¬ μ†λ„ μΈ΅μ •
- **λΉ„μ© ν¨μ¨μ„±**: API νΈμ¶ νμ κ°μ†λ΅ μΈν• λΉ„μ© μ μ•½ ν™•μΈ
- **λ™μ‹μ„±**: λ€λ‰ μ”μ²­ μ²λ¦¬ μ‹ μ‹μ¤ν… μ•μ •μ„± κ²€μ¦

### **2. ν’μ§ κ²€μ¦**
- **μ‘λ‹µ μΌκ΄€μ„±**: λ™μΌν• μ…λ ¥μ— λ€ν• μ‘λ‹µ ν’μ§ ν™•μΈ
- **νλ¥΄μ†λ‚ νΉμ„±**: TCI μ΅°ν•©λ³„ μ‘λ‹µμ μ°¨λ³„ν™” μ •λ„ κ²€μ¦
- **μ—λ¬ μ²λ¦¬**: λ‹¤μ–‘ν• μ—λ¬ μƒν™©μ—μ„μ μ‹μ¤ν… λ™μ‘ ν™•μΈ

### **3. ν™•μ¥μ„± ν…μ¤νΈ**
- **λ€μ©λ‰ μ²λ¦¬**: 275κ° μ‘λ‹µ(25κ° μ΅°ν•© Γ— 11κ° μ§λ¬Έ) μ²λ¦¬ λ¥λ ¥
- **λ©”λ¨λ¦¬ μ‚¬μ©λ‰**: λ€λ‰ λ°μ΄ν„° μ²λ¦¬ μ‹ λ©”λ¨λ¦¬ ν¨μ¨μ„±
- **λ„¤νΈμ›ν¬ μ•μ •μ„±**: μ¥μ‹κ°„ Batch μ‘μ—…μ μ•μ •μ„±

## ν…μ¤νΈ μ‹λ‚λ¦¬μ¤

### **κΈ°λ³Έ μ‹λ‚λ¦¬μ¤**
1. **λ‹¨μΌ μ§λ¬Έ ν…μ¤νΈ**: ν•λ‚μ μ§λ¬Έμ— λ€ν• 25κ° νλ¥΄μ†λ‚ μ‘λ‹µ
2. **μ „μ²΄ μ§λ¬Έ ν…μ¤νΈ**: 11κ° μ§λ¬Έμ— λ€ν• 275κ° μ‘λ‹µ
3. **μ—λ¬ λ³µκµ¬ ν…μ¤νΈ**: μΌλ¶€ μ‹¤ν¨ μ‹ μ¬μ‹λ„ λ° λ³µκµ¬

### **μ„±λ¥ ν…μ¤νΈ**
1. **λ°°μΉ ν¬κΈ°λ³„ μ„±λ¥**: 10κ°, 25κ°, 50κ° λ‹¨μ„ μ²λ¦¬ μ†λ„
2. **λ™μ‹ μ²λ¦¬ ν…μ¤νΈ**: μ—¬λ¬ Batch μ‘μ—… λ™μ‹ μ‹¤ν–‰
3. **λ©”λ¨λ¦¬ μ‚¬μ©λ‰ λ¨λ‹ν„°λ§**: μ²λ¦¬ κ³Όμ •μ—μ„μ λ©”λ¨λ¦¬ μ‚¬μ© ν¨ν„΄

### **ν’μ§ ν…μ¤νΈ**
1. **μ‘λ‹µ λ‹¤μ–‘μ„±**: νλ¥΄μ†λ‚λ³„ μ‘λ‹µμ μ°¨λ³„ν™” μ •λ„
2. **μΌκ΄€μ„± κ²€μ¦**: λ™μΌ μ΅°κ±΄μ—μ„μ μ‘λ‹µ μΌκ΄€μ„±
3. **TCI νΉμ„± λ°μ**: κΈ°μ§κ³Ό μ„±κ²©μ΄ μ‘λ‹µμ— μ λ€λ΅ λ°μλλ”μ§€ ν™•μΈ

## μ‚¬μ© λ°©λ²•

### **1. κΈ°λ³Έ ν…μ¤νΈ μ‹¤ν–‰**
```bash
# conda ν™κ²½ ν™μ„±ν™”
conda activate batchpro

# Jupyter λ…ΈνΈλ¶ μ‹¤ν–‰
cd batchtest
jupyter notebook "create_patients_answer (1).ipynb"
```

### **2. Batch API ν…μ¤νΈ**
```bash
# λ©”μΈ APIμ—μ„ Batch ν…μ¤νΈ
cd ../myapi
python test_batch_processing.py
```

### **3. μ„±λ¥ λΉ„κµ ν…μ¤νΈ**
```bash
# κ°λ³„ vs Batch μ²λ¦¬ μ„±λ¥ λΉ„κµ
python performance_comparison.py
```

## ν…μ¤νΈ λ°μ΄ν„° κµ¬μ΅°

### **JSONL ν•μ‹ μμ‹**
```json
{"model": "gpt-4-turbo-preview", "input": "μ§λ¬Έ: μ–΄λ””κ°€ λ¶νΈν•΄μ„ λ°©λ¬Έν•κ² λμ—λ‚μ”?\nνλ¥΄μ†λ‚: κ³ λ¦½λκ³  κ²μ΄ λ§μ€, λ―Έμ„±μ™ν•"}
{"model": "gpt-4-turbo-preview", "input": "μ§λ¬Έ: μ–΄λ””κ°€ λ¶νΈν•΄μ„ λ°©λ¬Έν•κ² λμ—λ‚μ”?\nνλ¥΄μ†λ‚: ν­λ°μ μΈ, λΉ„λ…Όλ¦¬μ μΈ"}
```

### **ν…μ¤νΈ μΌ€μ΄μ¤**
- **κΈ°λ³Έ μ§λ¬Έ**: 11κ° ν‘μ¤€ν™”λ μ‹¬λ¦¬ μƒλ‹΄ μ§λ¬Έ
- **νλ¥΄μ†λ‚ μ΅°ν•©**: 25κ° μ„ νƒλ TCI μ΅°ν•©
- **μ…λ ¥ λ³€ν•**: λ‹¤μ–‘ν• ν™μ μ •λ³΄ λ° μ¦μƒ

## μ„±λ¥ μ§€ν‘

### **μ²λ¦¬ μ‹κ°„**
- **κ°λ³„ μ²λ¦¬**: 10κ° μ‘λ‹µλ‹Ή ~30μ΄
- **Batch μ²λ¦¬**: 10κ° μ‘λ‹µλ‹Ή ~8μ΄
- **μ „μ²΄ μ²λ¦¬**: 275κ° μ‘λ‹µλ‹Ή ~27-28λ¶„

### **λΉ„μ© ν¨μ¨μ„±**
- **API νΈμ¶ κ°μ†**: κ°λ³„ μ²λ¦¬ λ€λΉ„ 90% μ΄μƒ κ°μ†
- **μ²λ¦¬ μ†λ„ ν–¥μƒ**: 3-5λ°° μ†λ„ ν–¥μƒ
- **λ™μ‹μ„± ν–¥μƒ**: μ—¬λ¬ μ”μ²­μ„ λ™μ‹μ— μ²λ¦¬

## λ¬Έμ  ν•΄κ²°

### **μΌλ°μ μΈ λ¬Έμ **
- **Rate Limit**: API νΈμ¶ κ°„κ²© μ΅°μ •
- **λ©”λ¨λ¦¬ λ¶€μ΅±**: λ°°μΉ ν¬κΈ° μ΅°μ •
- **λ„¤νΈμ›ν¬ μ¤λ¥**: μ¬μ‹λ„ λ΅μ§ κµ¬ν„

### **Batch API νΉν™” λ¬Έμ **
- **μ‘μ—… μƒνƒ ν™•μΈ**: `check_batch_status` ν™μ©
- **κ²°κ³Ό λ‹¤μ΄λ΅λ“**: `download_batch_results` ν™μ©
- **μ—λ¬ λ΅κ·Έ**: μƒμ„Έν• μ—λ¬ μ •λ³΄ ν™•μΈ

## λ¨λ‹ν„°λ§ λ° λ΅κΉ…

### **μ„±λ¥ λ¨λ‹ν„°λ§**
- **μ²λ¦¬ μ§„ν–‰λ¥ **: μ‹¤μ‹κ°„ μ§„ν–‰ μƒν™© ν‘μ‹
- **μ—λ¬μ¨**: μ‹¤ν¨ν• μ”μ²­ λΉ„μ¨ μ¶”μ 
- **μ‘λ‹µ μ‹κ°„**: κ° λ‹¨κ³„λ³„ μ†μ” μ‹κ°„ μΈ΅μ •

### **λ΅κ·Έ λ¶„μ„**
- **μ„±κ³µ/μ‹¤ν¨ ν¨ν„΄**: μ—λ¬ λ°μƒ ν¨ν„΄ λ¶„μ„
- **μ„±λ¥ νΈλ λ“**: μ‹κ°„μ— λ”°λ¥Έ μ„±λ¥ λ³€ν™” μ¶”μ 
- **λ¦¬μ†μ¤ μ‚¬μ©λ‰**: CPU, λ©”λ¨λ¦¬, λ„¤νΈμ›ν¬ μ‚¬μ©λ‰

## ν–¥ν›„ κ°μ„  κ³„ν

### **λ‹¨κΈ° κ°μ„ **
- **μ—λ¬ λ³µκµ¬ κ°•ν™”**: μλ™ μ¬μ‹λ„ λ° λ³µκµ¬ λ΅μ§
- **λ¨λ‹ν„°λ§ κ°μ„ **: μ‹¤μ‹κ°„ λ€μ‹λ³΄λ“ κµ¬μ¶•
- **ν…μ¤νΈ μλ™ν™”**: CI/CD νμ΄ν”„λΌμΈ κµ¬μ¶•

### **μ¥κΈ° κ°μ„ **
- **AI λ¨λΈ μµμ ν™”**: λ” ν¨μ¨μ μΈ λ¨λΈ μ„ νƒ
- **λ¶„μ‚° μ²λ¦¬**: μ—¬λ¬ μ„λ²„λ¥Ό ν™μ©ν• λ³‘λ ¬ μ²λ¦¬
- **μΊμ‹± μ‹μ¤ν…**: μμ£Ό μ‚¬μ©λλ” μ‘λ‹µ μΊμ‹±

## λΌμ΄μ„ μ¤
μ΄ ν”„λ΅μ νΈλ” MIT λΌμ΄μ„ μ¤ ν•μ— λ°°ν¬λ©λ‹λ‹¤.
